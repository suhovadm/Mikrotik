#1. ОПРЕДЕЛЕНИЕ ПУТИ НА РАБОЧИЙ СТОЛ ПОЛЬЗОВАТЕЛЯ.

# Для работы с файловой системой и путями.
import os

# 1. Заводим функцию для определения пути на рабочий стол пользователя.
def get_desktop_path():
    try:
        # Способ 1: Через переменную окружения USERPROFILE (самый надежный для Windows).
        # Получаем путь к папке пользователя из переменных окружения.
        user_profile = os.environ.get('USERPROFILE')
        if user_profile:

            # Создаём путь к рабочему столу.
            desktop_path = os.path.join(user_profile, 'Desktop')

            # Проверяем, существует ли папка рабочего стола.
            if os.path.exists(desktop_path):
                print(f"[V] Рабочий стол найден через USERPROFILE: {desktop_path}")
                return desktop_path
            else:
                print("[!] Папка Desktop не найдена в USERPROFILE")

        # Способ 2: Через домашнюю директорию (запасной вариант).
        # Функция, которая преобразует символ ~ в полный путь к домашней директории.
        # В Windows это C:\Users\ИмяПользователя\
        # В Linux/Mac это /home/ИмяПользователя\ или /Users/ИмяПользователя/
        home_dir = os.path.expanduser("~")
        # Функция для безопасного соединения путей.
        # Она автоматически использует правильные разделители для текущей ОС:
        # В Windows \ (обратный слэш)
        # В Linux/Mac / (прямой слэш)
        desktop_path = os.path.join(home_dir, 'Desktop')
        # Проверяем, существует ли указанный путь в файловой системе.
        if os.path.exists(desktop_path):
            print(f"[V] Рабочий стол найден через домашнюю директорию: {desktop_path}")
            return desktop_path # True если папка существует, False если нет.
        else:
            print("[!] Папка Desktop не найдена в домашней директории")

        # Способ 3: Если Desktop не найден, используем домашнюю директорию
        print(f"[V] Используем домашнюю директорию: {home_dir}")
        return home_dir

    # Перехватываем любую ошибку, которая может произойти в блоке try.
    except Exception as e:
        print(f"[x] Не удалось определить путь к рабочему столу: {e}")
        # Возвращаем текущую директорию как запасной вариант.
        # CWD - это папка, из которой был запущен Python-скрипт.
        current_dir = os.getcwd()
        print(f"[V] Используем текущую директорию: {current_dir}")
        # Возвращает текущую рабочую директорию как результат функции.
        # Это гарантирует, что функция ВСЕГДА вернёт какой-то путь, даже при ошибках.
        return current_dir