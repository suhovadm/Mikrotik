1. PPtP и его компоненты.

   В: Можно ли включить PPtP не имея на руках NAT?
   О: Да, можно. PPtP не требует NAT для работы в принципе.
   Point to Point Tunneling Protocol состоит из двух частей.
   Управляющее соединение Control Connection использует TCP-порт 1723.
   Данные туннеля используют GRE-протокол (IP протокол 47), а не TCP/UDP.
   Это не стандартный для NAT протокол, что и создаёт основную сложность.

3. Классическая схема работы и роль NAT.
Типичная проблема с PPtP возникает когда клиент находится ЗА NAT (например, в домашней сети).

--- Проблемы две:
1. GRE и NAT: многие простые NAT-устройства (роутеры) не умеют корректно обрабатывать
(пробрасывать) пакеты протокола GRE, которые не имеют стандартных портов. Для этого
требуется специальная функция PPtP Passthrought, она ещё называется ALG для PPtP, которая
как раз и встроена почти во все современные роутеры для клиентов.
2. Согласование адресов: серверу PPtP нужно знать реальный IP-адрес клиента для установки
GRE-туннеля. Если клиент за NAT, сервер видит IP-адрес NAT-устройства, а не клиента.
PPtP решает эту проблему в рамках своего управляющего соединения (TCP 1723), передавая нужный
адрес специальным полем. Снова помогает PPtP Passthrough на роутере.

Вывод: NAT создаёт проблему для PPtP-клиента, но не для сервера.

3. Сервер PPtP без NAT.
Если мы настраиваем PPtP-сервер, то нам NAT НЕ нужен. Более того, для корректной работы сервера
его лучше размещать в сети без NAT, либо сделать на шлюзе проброс (Port Forwarding) портов на сервер:
TCP:1723 -> на IP-адрес нашего PPtP-сервера.
Протокол GRE (IP 47) -> на IP-адрес нашего PPtP-сервера.

Идеальная конфигурация для PPtP-сервера:
1. У сервера есть реальный "белый" IP-адрес в интернете (или в целевой сети):
2. Клиенты подключаются напрямую к этому адресу.
3. Никакой NAT между сервером и клиентами не мешает.

Вывод:
- Для PPtP-клиента NAT на его стороне создаёт проблемы, которые решаются функцией PPtP Passthrough на роутере.
- Для PPtP-сервера NAT не только не нужен, но и часто мешает. Сервер должен быть доступен по публичному IP
или в сети, где до него можно "достучаться". Если сервер находится за NAT (например, в офисе), то нам нужно
будет настраивать Port Forwarding на корпоративном маршрутизаторе.

Ответ: да, можно и нужно включать и использовать PPtP-сервер, не имея на руках NAT.
Наличие NAT между сервером и клиентом - это дополнительная головная боль, которую нужно решать с помощью
проброса портов.
